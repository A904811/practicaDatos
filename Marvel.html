<html>
  <head>
    <title>Example API Marvel</title>
  </head>
  <body>
    
	<div id="content"></div>
	
	
	<p><b>Insert your private key</b></p>
    <input id="KEY" onChange="getMarvelResponse(this.value)" size='50' > </input>
	<p></p>
    <button onclick="getMarvelResponse(this.value)">Get Data</button>
	<p></p>
    
    <table id="myTable" border="1">
	<tr>
    <td><b>Number</b></td>
    <td><b>Title</b></td>
    <td><b>Image</b></td>
    
	</tr>
	</table>
	
  </body>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js"></script>

  <script>
// you will also have to setup the referring domains on your marvel developer portal


function getMarvelResponse(key) {
  // you need a new ts every request    

	var PRIV_KEY = key;
	var PUBLIC_KEY = "5d57b5486472bed47fabbe9c0c90fa42";
  var ts = new Date().getTime();
  var hash = CryptoJS.MD5(ts + PRIV_KEY + PUBLIC_KEY).toString();
  
  // the api deals a lot in ids rather than just the strings you want to use
  var characterId = '1009718'; // wolverine                                                                             
  var url = 'http://gateway.marvel.com:80/v1/public/comics';
  var request = new XMLHttpRequest();
    
	request.open('GET', 'https://gateway.marvel.com:443/v1/public/characters?apikey=5d57b5486472bed47fabbe9c0c90fa42&ts=' + ts + 
	  '&hash=' + hash, true);
    request.onreadystatechange = function() {
	
      if (request.status >= 200 && request.status < 400) {
        // Success!
        resp = request.responseText;
		console.log(resp);
        var data = JSON.parse(resp);
		
        // in production code, item.text should have the HTML entities escaped.
        //document.getElementById("content").innerHTML += "<br>" + item.volumeInfo.title;
		
		var table = document.getElementById("myTable");
		for (var i = 0; i < data.data.results.length; i++) {
		
        var row = table.insertRow(i+1);
		var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
       
        cell1.innerHTML = i;
		
		cell2.innerHTML = data.data.results[i].name;

        cell3.innerHTML =  "<img class='image' src='" + data.data.results[i].thumbnail.path + "." + data.data.results[i].thumbnail.extension + "' width='100'/>";
        
        //document.getElementById("key").value = "";
        //document.getElementById("key").focus();
		
		//<div id="content"></div>
    //<input id="KEY" onChange="getMarvelResponse(this.value)" autofocus></input>
    //<button onclick="getMarvelResponse(document.getElementById('KEY').value)">Get Data</button>
 
		
		//document.getElementById("extension").src =data.data.results[1].thumbnail.extension;
		
		}
      } else {
        // We reached our target server, but it returned an error
      }
    };
    request.send();
}
  
  /*
  $.getJSON(url, {
    ts: ts,
    apikey: PUBLIC_KEY,
    hash: hash,
    characters: characterId
    })
    .done(function(data) {
      // sort of a long dump you will need to sort through
      $("#div1").load("data");
    })
    .fail(function(err){
      // the error codes are listed on the dev site
      console.log(err);
    });
};
*/

//<input id="title"></input>

 //<button onclick="getMarvelResponse">Get Data</button>
 
 //<textarea id="title"></textarea>
 
 //<button type="button" onclick="getMarvelResponse ()">Get Data</button>
//<div id="content"></div>
 getMarvelResponse();

  </script>
  
</html>
